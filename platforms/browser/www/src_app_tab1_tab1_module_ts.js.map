{"version":3,"sources":["./src/app/calendar-api.service.ts","./src/app/tab1/tab1-routing.module.ts","./src/app/tab1/tab1.module.ts","./src/app/tab1/tab1.page.ts","./src/app/tab1/tab1.page.scss","./src/app/tab1/tab1.page.html"],"names":[],"mappings":"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","file":"src_app_tab1_tab1_module_ts.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CalendarApiService {\n\n  private apiKey:string = \"ba2e4dfa3ba60adc04e45b9b0d4225ec9e2b2373\";\n  private baseUrl: string = \"https://calendarific.com/api/v2\";\n\n  constructor(private http: HttpClient) { }\n\n  //get all holidays\n  //pass in required parameters(api_key, country & year) with the base url\n  getAllHolidays(){\n    return this.http.get(this.baseUrl + '/holidays?api_key=' + this.apiKey + '&country=SG&year=2021');\n  }\n\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab1Page } from './tab1.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab1Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab1PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab1Page } from './tab1.page';\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\nimport { NgCalendarModule  } from 'ionic2-calendar';\nimport { LocalNotifications } from '@ionic-native/local-notifications/ngx';\n\nimport { Tab1PageRoutingModule } from './tab1-routing.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    ExploreContainerComponentModule,\n    Tab1PageRoutingModule,\n    NgCalendarModule\n  ],\n  declarations: [Tab1Page],\n  providers: [LocalNotifications]\n})\nexport class Tab1PageModule {}\n","import { Component } from '@angular/core';\nimport { ModalController, NavController } from '@ionic/angular';\nimport { EventModalPage } from '../event-modal/event-modal.page';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { LocalNotifications } from '@ionic-native/local-notifications/ngx';\nimport { AuthService } from '../auth.service';\nimport { CalendarApiService } from '../calendar-api.service';\n@Component({\n  selector: 'app-tab1',\n  templateUrl: 'tab1.page.html',\n  styleUrls: ['tab1.page.scss']\n})\nexport class Tab1Page {\n\n  viewTitle: string;\n  eventSource = [];\n  selectedDay = new Date();\n  calendar = {\n    mode: 'month',\n    currentDate: new Date()\n  };\n  publicHolidays: any = [];\n\n  constructor(public navCtrl: NavController, private modalController: ModalController,\n     private firestore: AngularFirestore, private localNotification: LocalNotifications,\n     private auth: AuthService, private api: CalendarApiService) {\n\n      //get all public holidays from api and display in local calendar\n      this.api.getAllHolidays().subscribe((data)=> {\n        this.publicHolidays = data;\n        this.publicHolidays = this.publicHolidays.response.holidays;\n        this.publicHolidays.forEach(ele => {\n          let holiday: any = {};\n          holiday.title = ele.name;\n          holiday.startTime = new Date(ele.date.iso);\n          holiday.endTime = new Date(ele.date.iso);\n          this.eventSource.push(holiday);\n        });\n      })\n\n      //get all users events from firebase and display in local calendar\n      this.firestore.collection('Carts').doc('C' + this.auth.getUserId()).collection('Event').snapshotChanges().subscribe(colSnap => {\n      colSnap.forEach(snap => {\n        let event:any = snap.payload.doc.data();\n        event.id = snap.payload.doc.id;\n        event.startTime = (event.startTime).toDate();\n        event.endTime = (event.endTime).toDate();\n        this.eventSource.push(event);\n      })\n    })\n  }\n\n  //add new event\n  async addEvent() {\n    //create modal and pass in selected date\n    let modal = this.modalController.create(\n      {\n        component: EventModalPage,\n        componentProps:{\n          selectedDay: this.selectedDay\n        }\n      });\n    (await modal).present();\n    (await modal).onDidDismiss().then((data: any) => {\n      //if data exist\n      if (data) {\n        //create event var\n        const event = {\n          title: data.data.title,\n          startTime: new Date(data.data.startTime),\n          endTime: new Date(data.data.endTime),\n          allDay: data.data.allDay,\n        };\n        //add new event in database\n        this.firestore.collection('Carts').doc('C' + this.auth.getUserId()).collection('Event').add(event);\n        //push event into local eventSource to display in calendar\n        this.eventSource.push(event);\n        //set notification based on event startTime\n        this.set_notification(event.title, event.startTime);\n      }\n    });\n  }\n\n  //change month in title\n  onViewTitleChanged(title) {\n    this.viewTitle = title;\n  }\n\n  //edit or delete selected event\n  async onEventSelected(event) {\n    //disable editing or deleting of public holidays\n    //NOTE: public holidays do not have id field\n    if(event.id!=null){\n    let modal = this.modalController.create(\n      {\n        component: EventModalPage,\n        componentProps:{\n          id: event.id,\n          title: event.title,\n          startTime: event.startTime,\n          endTime: event.endTime,\n          allDay: event.allDay,\n        }\n      });\n    (await modal).present();\n    (await modal).onDidDismiss().then((data: any) => {\n      //update event only when data is available after editing and not after event is deleted \n      if (data.data) {\n        const event = {\n          title: data.data.title,\n          startTime: new Date(data.data.startTime),\n          endTime: new Date(data.data.endTime),\n          allDay: data.data.allDay,\n        };\n        this.firestore.collection('Carts').doc('C' + this.auth.getUserId()).collection('Event').doc(data.data.id).update(event);\n        this.eventSource.push(event);\n        this.set_notification(event.title, event.startTime);\n      }\n    });\n  }\n  }\n\n  onTimeSelected(ev) {\n    this.selectedDay = ev.selectedTime;\n  }\n\n  set_notification(title, date){\n    this.localNotification.schedule({\n      text: title,\n      trigger: {at: new Date(date.getTime())},\n      led: 'FF0000',\n      sound: null\n    });\n  }\n\n}\n","export default \"ion-fab {\\n  margin: 15px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhYjEucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksWUFBQTtBQUNKIiwiZmlsZSI6InRhYjEucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWZhYiB7XHJcbiAgICBtYXJnaW46IDE1cHg7XHJcbn0iXX0= */\";","export default \"<ion-header [translucent]=\\\"true\\\">\\n    <ion-toolbar>\\n        <ion-title>\\n            {{viewTitle}}\\n        </ion-title>\\n    </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n    <calendar [eventSource]=\\\"eventSource\\\" [calendarMode]=\\\"calendar.mode\\\" [currentDate]=\\\"calendar.currentDate\\\" (onEventSelected)=\\\"onEventSelected($event)\\\" (onTitleChanged)=\\\"onViewTitleChanged($event)\\\" (onTimeSelected)=\\\"onTimeSelected($event)\\\" step=\\\"30\\\" class=\\\"calendar\\\">\\n    </calendar>\\n\\n    <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"end\\\" slot=\\\"fixed\\\">\\n        <ion-fab-button [disabled]=\\\"!auth.isLoggedIn()\\\" (click)=\\\"addEvent()\\\">\\n            <ion-icon name=\\\"add\\\"></ion-icon>\\n        </ion-fab-button>\\n    </ion-fab>\\n</ion-content>\";"],"sourceRoot":"webpack:///"}